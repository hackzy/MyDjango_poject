<!DOCTYPE html>
<html>
{% load static %}
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title> - 登录</title>
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/font-awesome.css' %}" rel="stylesheet">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
</head>

<body class="gray-bg">

    <div class="middle-box text-center loginscreen  animated fadeInDown">
        <div>
            <div>

                <h1 class="logo-name">xk</h1>

            </div>
            <h3>欢迎使用</h3>

            <form class="m-t" role="form" id='login'>
                {% csrf_token %}
                <div class="form-group">
                    <input type="username" name="username" class="form-control" placeholder="用户名" required="">
                </div>
                <div class="form-group">
                    <input type="password" name="password" class="form-control" placeholder="密码" required="">
                </div>
                <div class="alert alert-warning" style="display:none"></div>
                <button type="submit" class="btn btn-primary block full-width m-b" >登 录</button>

            </form>
        </div>
    </div>

    <!-- 全局js -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script>
        $('#login').on('submit',function(event){
            event.preventDefault();
            $.ajax({
                url:'login',
                type:'POST',
                data:$(this).serialize(),
                success:function(response){
                    if (window.top !== window.self){
                        window.top.location.href = '/'
                    }
                    else{
                        window.location.href = '/';
                    } 
                },
                error:function(xhr){
                    $('.alert').text(xhr.responseJSON.error).show()
                }
            })
        });
        
    </script>
    

</body>

</html>
